{"version":3,"sources":["webpack:///webpack/bootstrap 563cdb49300e401a8855","webpack:///./js/http-promise.js","webpack:///./js/farmer.js"],"names":["get","url","dataType","Promise","resolve","reject","$","ajax","type","async","statusCode","response","Error","error","jqXHR","status","getXMLHttpRequest","request","XMLHttpRequest","onreadystatechange","readyState","DONE","open","send","HttpClient","callback","responseText","console","log","http","BASE_URL","getLocal","zip","then","data","getDetail","id","getAll","marketData","i","length","market","printData","getGoogleLink","link","encodeURI","getMarketAddress","address","join","addSummary","parent","summary","document","createElement","className","name","milesAndName","split","addClass","appendTo","text","innerHTML","appendChild","append","makeSummaries","markets","numberToAdd","lastDisplayed","hasMore","removeClass","init","undefined","click","e","empty","val","catch","err","ready"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 563cdb49300e401a8855","// Implementation with jQuery\nexport const get = function(url, dataType='text') {\n    // return new pending promise\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            url: url,\n            type: 'GET',\n            dataType: dataType,\n            async: true,\n            statusCode: {\n                404: (response) => reject(new Error('404 error - response: ' + response)),\n                200: (response) => resolve(response)\n            },\n            error: (jqXHR, status, error) => {\n                reject(new Error('Failed to load the thing - status ' + status));\n            }\n        });\n    });\n};\n\n\n// Implementation with XMLHttpRequest\nexport const getXMLHttpRequest = function(url) {\n    // return new pending promise\n    return new Promise((resolve, reject) => {\n        const request = new XMLHttpRequest();\n        request.onreadystatechange = () => {\n            if (request.readyState == XMLHttpRequest.DONE && request.status == 200) {\n                resolve(request.response);\n            } else if (request.readyState == XMLHttpRequest.DONE &&\n                       (request.status < 200 || request.status > 299)) {\n                reject(new Error('Failed to load page - status: ' + request.status));\n            }\n        };\n        request.open('GET', url);\n        request.send(null);\n    })\n};\n\n\n\nvar HttpClient = function() {\n    this.get = function(url, callback) {\n        let request = new XMLHttpRequest();\n        request.onreadystatechange = function() {\n            if (request.readyState == 4 && request.status == 200) {\n                callback(request.responseText);\n            } else {\n                console.log('--------- Error! ---------');\n                console.log(request);\n            }\n        }\n        request.open('GET', url, true);\n        request.send(null);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/http-promise.js","import * as http from './http-promise';\n\nconst BASE_URL = 'http://127.0.0.1:5000/yourmarket/api'\n\n\nfunction getLocal(zip, callback) {\n    const url = BASE_URL + '/zip/' + zip;\n    return http.get(url, 'json').then((data) => data['results']);\n}\n\nfunction getDetail(id) {\n    const url = BASE_URL + '/id/' + id;\n    return http.get(url, 'json');\n}\n\nfunction getAll(marketData) {\n    for (var i=0; i < marketData.length; i++) {\n        let market = marketData[i];\n        getDetail(market['id'])\n            .then(printData);\n    }\n}\n\n// Get Google Maps link from market detail data\nfunction getGoogleLink(market) {\n    const link = 'https://maps.google.com/?q=' + encodeURI(market['y'] + ',' +\n                            market['x'] + ' (\"' + market['MarketName'] + '\")');\n    return (link);\n}\n\nfunction getMarketAddress(market) {\n    const address = [market['street'], market['city'], market['zip']].join(', ');\n    return (address);\n}\n\n\nfunction addSummary(market, parent) {\n    const summary = document.createElement('div');\n    summary.className = 'market-summary';\n\n    // Create header for elemen\n    const name = document.createElement('h3');\n    const milesAndName = market['marketname'].split(/ (.+)/);\n    $('<span>' + milesAndName[0] + 'mi</span>').addClass('distance').appendTo(name);\n    $('<span> ' + milesAndName[1] + '</span>').addClass('market-name').appendTo(name);\n\n    getDetail(market['id'])\n        .then((data) => {\n            const address = document.createElement('p');\n            const link = getGoogleLink(data);\n            const text = getMarketAddress(data);\n            address.innerHTML = '<a href=' + link + '>' + text + '</a>';\n            summary.appendChild(address);\n        });\n\n    summary.appendChild(name);\n    parent.append(summary);\n}\n\nfunction makeSummaries(markets, parent, numberToAdd) {\n    for (var i=markets.lastDisplayed;\n         i < markets.lastDisplayed + numberToAdd; i++) {\n        // if all the markets have been displayed, break\n        if (i > markets.data.length - 1) {\n            break;\n        }\n        addSummary(markets.data[i], parent);\n    }\n    markets.lastDisplayed = i;\n    if (markets.hasMore()) {\n        $('#more-results').removeClass('visible');\n    }\n}\n\n\nfunction init() {\n    // Market data singleton\n    const markets = {\n        data: [],\n        lastDisplayed: 0,\n        hasMore: function () { // can't use arrow function due to 'this' binding\n            return (this.data != undefined && this.lastDisplayed < this.data.length);\n        },\n    };\n\n    // Listen for zip code search\n    $('#submit-search').click((e) => {\n        // clear old results\n        $('.market-summary-wrapper').empty();\n        markets.data = {};\n        markets.lastDisplayed = 0;\n\n        // generate new results\n        getLocal($('#zipcode').val())\n            .then((data) => {\n                markets.data = data;\n                makeSummaries(markets, $('#summary-wrapper'), 9);\n\n                // Display button to get more results\n                if (markets.hasMore()) {\n                    $('#more-results').addClass('visible');\n                    $('#more-results').click((e) => {\n                        makeSummaries(markets, $('#summary-wrapper'), 9);\n                    });\n                }\n            })\n            .catch((err) => console.log(err));\n    });\n}\n\n$(document).ready(init);\n\n\n\n// WEBPACK FOOTER //\n// ./js/farmer.js"],"sourceRoot":""}